<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Accion Descuentos Vendedores !-->
    <record id="user_discount_action" model="ir.actions.act_window">
        <field name="name">Descuentos Vendedor</field>
        <field name="res_model">res.users.discount</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="user_discount_form_view" model="ir.ui.view">
        <field name="name">users.discount.form.view</field>
        <field name="model">res.users.discount</field>
        <field name="arch" type="xml">
            <form string="Descuentos">
                <sheet>
                    <group>
                        <group>
                            <field name="seller_id" required="1"/>
                            <field name="discount_permitted" string="Descuento Maximo Permitido %" required="1"/>
                            <field name="almacen_id" required="1"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Categorias permitidas">
                            <field name="category_ids" widget="many2many" required="1"/>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="user_discount_tree_view" model="ir.ui.view">
        <field name="name">users.discount.tree.view</field>
        <field name="model">res.users.discount</field>
        <field name="arch" type="xml">
            <tree string="Lista de Descuentos">
                <field name="seller_id"/>
                <field name="discount_permitted" string="Descuento Maximo Permitido"/>
                <field name="almacen_id"/>
                <field name="category_ids" widget="many2many_tags"/>
            </tree>

        </field>
    </record>

    <!-- Menu "Descuento Vendedores" !-->
    <menuitem
            name="Descuentos Vendedores"
            id="user_discount_menu"
            parent="sale.sale_order_menu"
            sequence="1"
            action="user_discount_action"
    />

    <record id="sale_order_inherit_form" model="ir.ui.view">
        <field name="name">sale.order.inherit.form</field>
        <field name="model">sale.order</field>
        <field name="type">form</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//header" position="inside">

                <button name="send_mail_discount" string="Solicitar Descuento Mayor" type="object" attrs="{'invisible': ['|',('state', 'not in', ['draft']),('need_discount_aprove','=',False)]}"/>
            </xpath>
            <xpath expr="//field[@name='partner_id']" position="after">
                <field name="need_discount_aprove"/>
            </xpath>
            <xpath expr="//field[@name='order_line']/form/group/group/div[@name='discount]/field[@name='discount']" position="attributes">
                 <attribute name="attrs">{'readonly':[('state','=', 'sent')]}</attribute>
                 <attribute name="style"> background:Red </attribute>

            </xpath>
        </field>
    </record>



</odoo>
